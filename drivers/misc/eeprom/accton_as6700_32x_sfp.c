/*
 * An hwmon driver for accton as6700_32x sfp
 *
 * Copyright (C)  Polly Hsu <polly_hsu@accton.com.tw>
 *
 * Based on ad7414.c
 * Copyright 2006 Stefan Roese <sr at denx.de>, DENX Software Engineering
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

#include <linux/module.h>
#include <linux/jiffies.h>
#define DEBUG  1  /* enable dev_dbg */
#include <linux/i2c.h>
#include <linux/hwmon.h>
#include <linux/hwmon-sysfs.h>
#include <linux/err.h>
#include <linux/mutex.h>
#include <linux/sysfs.h>
#include <linux/slab.h>

/* NAMING CONSTANT DECLARATIONS
*/
#define AS6700_32X_MAX_NBR_OF_SFP_PORT            32
#define AS6700_32X_MAX_NBR_OF_SFP_EEPROM          256
#define AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF  9

#define AS6700_32X_DRVNAME                        "acc_as6700_32x_sfp"

/* PORT number here is indexed from 1 
 * as the front port number
 */
#define AS6700_32X_SFP_NORMAL_PORT_PRESENT_WIDTH  3
#define AS6700_32X_SFP_NORMAL_PORT_MIN            1
#define AS6700_32X_SFP_NORMAL_PORT_MAX            20
/* {QSFP:  0 ~ 7 (Front port 1~ 8), QSFP:  8 ~ 15,  QSFP: 16 ~ 19}
 */
#define AS6700_32X_SFP_NORMAL_PORT_BLOCK          8


#define AS6700_32X_SFP_MODULE_EXIST_WIDTH         2
#define AS6700_32X_SFP_MODULE_PORT_PRESENT_WIDTH  2
#define AS6700_32X_SFP_MODULE_PORT_MIN            21
#define AS6700_32X_SFP_MODULE_PORT_MAX            32
#define AS6700_32X_SFP_MODULE_ONE_PORT_MIN        21
#define AS6700_32X_SFP_MODULE_ONE_PORT_MAX        26
#define AS6700_32X_SFP_MODULE_ONE_INDEX           0
#define AS6700_32X_SFP_MODULE_TWO_INDEX           1

#define AS6700_32X_SFP_ERROR_CODE                 -1

#define AS6700_32X_SFP_CPLD_ADDR                  0x31
#define AS6700_32X_SFP_IO_EXPANDER_ADDR           0x20 /* abbrivate: IE */
#define AS6700_32X_SFP_SWITCH_IC_ADDR             0x70

#define AS6700_32X_SFP_SWITCH_CHANNEL_REG         0x60 /* abbrivate: SC */
#define AS6700_32X_SFP_SWITCH_IC_MODULE_REG       0x0  /* abbrivate: SI */

#define AS6700_32X_SFP_SC_INACTIVATE_VLAUE        0x0
#define AS6700_32X_SFP_EQUALIZER_TYPE_NAME_LEN    48


/* MACRO FUNCTION DECLARATIONS
*/
#define AS6700_32X_SFP_IS_MODULE_PORT(front_port)  \
       (((front_port >= AS6700_32X_SFP_MODULE_PORT_MIN) && (front_port <= AS6700_32X_SFP_MODULE_PORT_MAX)) ? \
         1: 0)
#define AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(front_port) (front_port-1) /* array is indexed from 0*/

#define AS6700_32X_SFP_GET_NORMAL_PORT_BLOCK_INDEX(driver_port) (driver_port/8)
#define AS6700_32X_SFP_GET_NORMAL_PORT_BLOCK_BIT_INDEX(driver_port) (driver_port%8)

#define AS6700_32X_SFP_GET_MODULE_PORT_BLOCK_INDEX(driver_port) ((driver_port - (AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(AS6700_32X_SFP_MODULE_PORT_MIN))) / 6)
#define AS6700_32X_SFP_GET_MODULE_PORT_BLOCK_BIT_INDEX(driver_port) (((driver_port - (AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(AS6700_32X_SFP_MODULE_PORT_MIN))) % 6) + 2) /* indexed from bit 2*/
#define AS6700_32X_SFP_GET_SC_MODULE_PORT_VALUE_INDEX(driver_port)  \
       (((driver_port >= AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(AS6700_32X_SFP_MODULE_ONE_PORT_MIN)) && (driver_port <= AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(AS6700_32X_SFP_MODULE_ONE_PORT_MAX))) ? \
         0: 1)
#define AS6700_32X_SFP_GET_SI_MODULE_PORT_VALUE_INDEX(front_port)  \
       (((front_port) - AS6700_32X_SFP_NORMAL_PORT_MAX) % sizeof(as6700_32x_SI_module_port_value))

/* DATA TYPE DECLARATIONS
 */
enum as6700_32x_sfp_sysfs_attributes {
    AS6700_32X_SFP_IS_PRESENT,
    AS6700_32X_ACTIVE_PORT,
    AS6700_32X_EEPROM,
    AS6700_32X_EQUALIZER,
    AS6700_32X_DEBUG
};

enum as6700_32x_sfp_tranceiver_cable_type {
    AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_FIBER=0,
    AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_1M=1,
    AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_3M=3,
    AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_5M=5,
    AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_7M=7
};

/* Each client has this additional data 
 */
struct as6700_32x_sfp_data {
    struct device      *hwmon_dev;
    struct mutex        update_lock;
    char                valid;               /* !=0 if registers are valid */
    unsigned long       last_updated;        /* In jiffies */
    long                active_port;         /* need to define long for kstrtol, indexed from 1 */
    char                eeprom[AS6700_32X_MAX_NBR_OF_SFP_EEPROM];
    long                cable_type;          /* need to define long for kstrtol */
    int                 update_normal_port_status[AS6700_32X_SFP_NORMAL_PORT_PRESENT_WIDTH]; /* 3 */
    int                 update_module_exist_status[AS6700_32X_SFP_MODULE_EXIST_WIDTH]; /*2 */
    int                 update_module_port_status[AS6700_32X_SFP_MODULE_PORT_PRESENT_WIDTH]; /*2 */
    u8                  normal_port_present[AS6700_32X_SFP_NORMAL_PORT_PRESENT_WIDTH]; /* 3 */
    u8                  module_exist[AS6700_32X_SFP_MODULE_EXIST_WIDTH]; /* 0: M1, 1:M2 */
    u8                  module_port_present[AS6700_32X_SFP_MODULE_PORT_PRESENT_WIDTH]; /*2 */
    int                 is_present;
    int                 is_failed;
    int                 is_debug;
};

typedef struct sfp_equalizer_config_s
{
    u8 addr;
    u8 reg;
    u8 value;
} sfp_equalizer_config_t;

typedef struct sfp_equalizer_entry_s
{
    int front_port;
    sfp_equalizer_config_t sc_inactivate;
    sfp_equalizer_config_t tx_sc_activate;
    sfp_equalizer_config_t tx_entry[AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF];
    sfp_equalizer_config_t rx_sc_activate;
    sfp_equalizer_config_t rx_entry[AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF];
} sfp_equalizer_entry_t;

/* EXTERN SUBPROGRAM DECLARATIONS
*/
extern int accton_i2c_cpld_read(unsigned short cpld_addr, u8 reg);
extern int accton_i2c_cpld_write(unsigned short cpld_addr, u8 reg, u8 value);


/* LOCAL SUBPROGRAM DECLARATIONS
*/
static ssize_t show_status(struct device *dev, struct device_attribute *da,char *buf);
static ssize_t show_active_port(struct device *dev, struct device_attribute *da, char *buf);
static ssize_t set_active_port(struct device *dev, struct device_attribute *da,
			const char *buf, size_t count);
static ssize_t show_eeprom(struct device *dev, struct device_attribute *da, char *buf);
static ssize_t set_sfp_equalizer(struct device *dev, struct device_attribute *da,
			const char *buf, size_t count);
static ssize_t show_sfp_debug(struct device *dev, struct device_attribute *da, char *buf);
static ssize_t set_sfp_debug(struct device *dev, struct device_attribute *da,
			     const char *buf, size_t count);

static int as6700_32x_sfp_read_block(struct i2c_client *client, u8 command, u8 *data,int data_len);
static struct as6700_32x_sfp_data *as6700_32x_sfp_update_present(struct device *dev);             
static struct as6700_32x_sfp_data *as6700_32x_sfp_update_eeprom(struct device *dev);             
static int as6700_32x_sfp_read_normal_port_present(struct i2c_client *client);
static int as6700_32x_sfp_read_module_port_present(struct i2c_client *client);
static int as6700_32x_sfp_read_normal_port_eeprom(struct i2c_client *client);
static int as6700_32x_sfp_read_module_port_eeprom(struct i2c_client *client);
static int as6700_32x_sfp_equalizer_write(struct i2c_client *client);
static void as6700_32x_sfp_debug_present_dump(struct device *dev);
static void as6700_32x_sfp_debug_eeprom_dump(struct device *dev);

/* sysfs attributes for hwmon 
 */
static SENSOR_DEVICE_ATTR(sfp_is_present,  S_IRUGO, show_status,     NULL, AS6700_32X_SFP_IS_PRESENT);
static SENSOR_DEVICE_ATTR(sfp_active_port, S_IWUSR | S_IRUGO, show_active_port, set_active_port, AS6700_32X_ACTIVE_PORT);
static SENSOR_DEVICE_ATTR(sfp_eeprom,      S_IRUGO, show_eeprom,    NULL, AS6700_32X_EEPROM);
static SENSOR_DEVICE_ATTR(sfp_equalizer,   S_IWUSR, NULL, set_sfp_equalizer, AS6700_32X_EQUALIZER);
static SENSOR_DEVICE_ATTR(sfp_debug,       S_IWUSR | S_IRUGO, show_sfp_debug, set_sfp_debug, AS6700_32X_DEBUG);

static struct attribute *as6700_32x_sfp_attributes[] = {
    &sensor_dev_attr_sfp_is_present.dev_attr.attr,
    &sensor_dev_attr_sfp_active_port.dev_attr.attr,
    &sensor_dev_attr_sfp_eeprom.dev_attr.attr,
    &sensor_dev_attr_sfp_equalizer.dev_attr.attr,
    &sensor_dev_attr_sfp_debug.dev_attr.attr,
    NULL
};


/* STATIC VARIABLE DEFINITIONS
*/
/* Addresses scanned 
 */
static const unsigned short normal_i2c[] = { 0x50, I2C_CLIENT_END };
/* CPLD read
 */
/* {QSFP:  0 ~ 7 (Front port 1~ 8), QSFP:  8 ~ 15,  QSFP: 16 ~ 19} 
 */
static u8 as6700_32x_CPLD_normal_port_present_offset[] =  {0x04, 0x05, 0x06};

/* bit 0: Module 1 (near the front ports); bit 1: Module 2 
 */
static u8 as6700_32x_CPLD_module_exist_offset[] =  {0x3};
static u8 as6700_32x_IE_module_io_expander_offset[] =  {0x02};

/* CPLD write
 */
/* Front port 1~ 20 -> 0x01~ 0x20 
 */
static u8 as6700_32x_SC_normal_port_value[] =  {0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x10,
                                                0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x20};
/* Module 1: 0x21,  Module 2: 0x22} 
 */
static u8 as6700_32x_SC_module_port_value[] =  {0x21, 0x22};
/* {Module 1: Front port 21~26-> 0x01~0x20; Module 2: port 27~32-> 0x01~0x20}
 */
static u8 as6700_32x_SI_module_port_value[] =  {0x01, 0x02, 0x04, 0x08, 0x10, 0x20};

static sfp_equalizer_entry_t as6700_32x_sfp_equalizer_table_copper_1M[] = {
{1,{0x31,0x60,0x0},
{0x31,0x60,0x01},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x01},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x14},{0x18,0x2d,0x84},{0,0,0},{0,0,0},{0,0,0}}},
{2,{0x31,0x60,0x0},
{0x31,0x60,0x02},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x02},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{3,{0x31,0x60,0x0},
{0x31,0x60,0x03},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x03},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{4,{0x31,0x60,0x0},
{0x31,0x60,0x04},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x04},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{5,{0x31,0x60,0x0},
{0x31,0x60,0x05},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x05},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{6,{0x31,0x60,0x0},
{0x31,0x60,0x06},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x06},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x54},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{7,{0x31,0x60,0x0},
{0x31,0x60,0x07},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x07},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{8,{0x31,0x60,0x0},
{0x31,0x60,0x08},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x08},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{9,{0x31,0x60,0x0},
{0x31,0x60,0x09},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x09},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{10,{0x31,0x60,0x0},
{0x31,0x60,0x10},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x10},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{11,{0x31,0x60,0x0},
{0x31,0x60,0x11},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x11},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{12,{0x31,0x60,0x0},
{0x31,0x60,0x12},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x12},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{13,{0x31,0x60,0x0},
{0x31,0x60,0x13},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x13},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{14,{0x31,0x60,0x0},
{0x31,0x60,0x14},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x14},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{15,{0x31,0x60,0x0},
{0x31,0x60,0x15},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x15},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{16,{0x31,0x60,0x0},
{0x31,0x60,0x16},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x16},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{17,{0x31,0x60,0x0},
{0x31,0x60,0x17},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x17},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{18,{0x31,0x60,0x0},
{0x31,0x60,0x18},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x18},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x51},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{19,{0x31,0x60,0x0},
{0x31,0x60,0x19},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x19},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{20,{0x31,0x60,0x0},
{0x31,0x60,0x20},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x57},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x20},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{21,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x01},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{22,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x02},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x11},{0x19,0x2d,0x81},{0,0,0}}},
{23,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x03},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{24,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x04},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x82},{0,0,0}}},
{25,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x05},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{26,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x06},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{27,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x07},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{28, {0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x08},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{29,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x09},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x84},{0,0,0}}},
{30,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x10},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x57},{0x19,0x2d,0x87},{0,0,0}}},
{31,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x11},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
{32,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x12},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
};

static sfp_equalizer_entry_t as6700_32x_sfp_equalizer_table_copper_3M[] = {
{1,{0x31,0x60,0x0},
{0x31,0x60,0x01},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x01},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x14},{0x18,0x2d,0x84},{0,0,0},{0,0,0},{0,0,0}}},
{2, {0x31,0x60,0x0},
{0x31,0x60,0x02},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x02},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{3,{0x31,0x60,0x0},
{0x31,0x60,0x03},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x03},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{4,{0x31,0x60,0x0},
{0x31,0x60,0x04},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x04},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{5,{0x31,0x60,0x0},
{0x31,0x60,0x05},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x05},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{6,{0x31,0x60,0x0},
{0x31,0x60,0x06},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x06},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x54},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{7,{0x31,0x60,0x0},
{0x31,0x60,0x07},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x07},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{8,{0x31,0x60,0x0},
{0x31,0x60,0x08},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x08},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{9,{0x31,0x60,0x0},
{0x31,0x60,0x09},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x09},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{10,{0x31,0x60,0x0},
{0x31,0x60,0x10},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x10},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{11,{0x31,0x60,0x0},
{0x31,0x60,0x11},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x11},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{12,{0x31,0x60,0x0},
{0x31,0x60,0x12},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x12},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{13,{0x31,0x60,0x0},
{0x31,0x60,0x13},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x13},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{14,{0x31,0x60,0x0},
{0x31,0x60,0x14},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x14},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{15,{0x31,0x60,0x0},
{0x31,0x60,0x15},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x15},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{16,{0x31,0x60,0x0},
{0x31,0x60,0x16},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x16},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{17,{0x31,0x60,0x0},
{0x31,0x60,0x17},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x17},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{18,{0x31,0x60,0x0},
{0x31,0x60,0x18},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x18},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x51},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{19,{0x31,0x60,0x0},
{0x31,0x60,0x19},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x19},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{20,{0x31,0x60,0x0},
{0x31,0x60,0x20},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x85},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x20},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{21,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x01},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{22,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x02},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x11},{0x19,0x2d,0x81},{0,0,0}}},
{23,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x03},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{24,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x04},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x82},{0,0,0}}},
{25,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x05},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{26,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x06},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{27,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x57},{0x18,0x2d,0x85}},
{0x31,0x60,0x07},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{28,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x08},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{29,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x09},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x84},{0,0,0}}},
{30,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x10},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x57},{0x19,0x2d,0x87},{0,0,0}}},
{31,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x11},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
{32,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x85}},
{0x31,0x60,0x12},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
};

static sfp_equalizer_entry_t as6700_32x_sfp_equalizer_table_copper_5_7_M[] = {
{1,{0x31,0x60,0x0},
{0x31,0x60,0x01},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x01},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x14},{0x18,0x2d,0x84},{0,0,0},{0,0,0},{0,0,0}}},
{2,{0x31,0x60,0x0},
{0x31,0x60,0x02},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x02},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{3,{0x31,0x60,0x0},
{0x31,0x60,0x03},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x03},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{4,{0x31,0x60,0x0},
{0x31,0x60,0x04},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x04},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{5,{0x31,0x60,0x0},
{0x31,0x60,0x05},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x05},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{6,{0x31,0x60,0x0},
{0x31,0x60,0x06},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x06},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x54},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{7,{0x31,0x60,0x0},
{0x31,0x60,0x07},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x07},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{8,{0x31,0x60,0x0},
{0x31,0x60,0x08},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x08},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{9,{0x31,0x60,0x0},
{0x31,0x60,0x09},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x09},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{10,{0x31,0x60,0x0},
{0x31,0x60,0x10},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x10},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{11,{0x31,0x60,0x0},
{0x31,0x60,0x11},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x11},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{12,{0x31,0x60,0x0},
{0x31,0x60,0x12},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x12},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{13,{0x31,0x60,0x0},
{0x31,0x60,0x13},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x13},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{14,{0x31,0x60,0x0},
{0x31,0x60,0x14},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x14},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{15,{0x31,0x60,0x0},
{0x31,0x60,0x15},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x15},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{16,{0x31,0x60,0x0},
{0x31,0x60,0x16},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x16},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{17,{0x31,0x60,0x0},
{0x31,0x60,0x17},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x17},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{18,{0x31,0x60,0x0},
{0x31,0x60,0x18},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x18},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x51},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{19,{0x31,0x60,0x0},
{0x31,0x60,0x19},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x19},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{20,{0x31,0x60,0x0},
{0x31,0x60,0x20},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x17},{0x1a,0x2d,0x87},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x20},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{21,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x01},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{22,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x02},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x11},{0x19,0x2d,0x81},{0,0,0}}},
{23,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x03},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{24,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x04},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x82},{0,0,0}}},
{25,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x05},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{26,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x06},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{27,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x07},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{28,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x08},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{29,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x09},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x84},{0,0,0}}},
{30,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x10},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x57},{0x19,0x2d,0x87},{0,0,0}}},
{31,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x11},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
{32,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x17},{0x18,0x2d,0x87}},
{0x31,0x60,0x12},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
};

static sfp_equalizer_entry_t as6700_32x_sfp_equalizer_table_fiber[] = {
{1,{0x31,0x60,0x0},
{0x31,0x60,0x01},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x01},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x14},{0x18,0x2d,0x84},{0,0,0},{0,0,0},{0,0,0}}},
{2,{0x31,0x60,0x0},
{0x31,0x60,0x02},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x02},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{3,{0x31,0x60,0x0},
{0x31,0x60,0x03},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x03},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}}},
{4,{0x31,0x60,0x0},
{0x31,0x60,0x04},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x04},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{5,{0x31,0x60,0x0},
{0x31,0x60,0x05},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x05},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{6,{0x31,0x60,0x0},
{0x31,0x60,0x06},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x06},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x54},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{7,{0x31,0x60,0x0},
{0x31,0x60,0x07},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x07},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{8,{0x31,0x60,0x0},
{0x31,0x60,0x08},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x08},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{9,{0x31,0x60,0x0},
{0x31,0x60,0x09},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x09},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{10,{0x31,0x60,0x0},
{0x31,0x60,0x10},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x10},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{11,{0x31,0x60,0x0},
{0x31,0x60,0x11},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x11},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{12,{0x31,0x60,0x0},
{0x31,0x60,0x12},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x12},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{13,{0x31,0x60,0x0},
{0x31,0x60,0x13},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x13},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{14,{0x31,0x60,0x0},
{0x31,0x60,0x14},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x14},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{15,{0x31,0x60,0x0},
{0x31,0x60,0x15},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x15},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x10},{0x18,0x2d,0x80},{0,0,0},{0,0,0},{0,0,0}}},
{16,{0x31,0x60,0x0},
{0x31,0x60,0x16},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x16},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{17,{0x31,0x60,0x0},
{0x31,0x60,0x17},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x17},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{18,{0x31,0x60,0x0},
{0x31,0x60,0x18},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x18},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x51},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{19,{0x31,0x60,0x0},
{0x31,0x60,0x19},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x19},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x11},{0x18,0x2d,0x82},{0,0,0},{0,0,0},{0,0,0}}},
{20,{0x31,0x60,0x0},
{0x31,0x60,0x20},{{0x1a,0xff,0x0c},{0x1a,0x36,0x01},{0x1a,0x0a,0x1c},{0x1a,0x0a,0x10},{0x1a,0x15,0x12},{0x1a,0x2d,0x83},{0,0,0},{0,0,0},{0,0,0}},
{0x31,0x60,0x20},{{0x18,0xff,0x0c},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x81},{0,0,0},{0,0,0},{0,0,0}}},
{21,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x81}},
{0x31,0x60,0x01},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{22,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83}},
{0x31,0x60,0x02},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x11},{0x19,0x2d,0x81},{0,0,0}}},
{23,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x81}},
{0x31,0x60,0x03},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x51},{0x19,0x2d,0x81},{0,0,0}}},
{24,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83}},
{0x31,0x60,0x04},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x82},{0,0,0}}},
{25,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x52},{0x18,0x2d,0x81}},
{0x31,0x60,0x05},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{26,{0x31,0x60,0x0},
{0x31,0x60,0x21},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83}},
{0x31,0x60,0x06},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x53},{0x19,0x2d,0x83},{0,0,0}}},
{27,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x01},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x81}},
{0x31,0x60,0x07},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{28,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x02},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83}},
{0x31,0x60,0x08},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x83},{0,0,0}}},
{29,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x04},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x81}},
{0x31,0x60,0x09},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x12},{0x19,0x2d,0x84},{0,0,0}}},
{30,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x08},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83}},
{0x31,0x60,0x10},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x57},{0x19,0x2d,0x87},{0,0,0}}},
{31,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x10},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x53},{0x18,0x2d,0x81}},
{0x31,0x60,0x11},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
{32,{0x31,0x60,0x0},
{0x31,0x60,0x22},{{0x70,0x00,0x20},{0x18,0xff,0x0c},{0x18,0x1e,0xe1},{0x18,0x31,0x40},{0x18,0x36,0x01},{0x18,0x0a,0x1c},{0x18,0x0a,0x10},{0x18,0x15,0x12},{0x18,0x2d,0x83}},
{0x31,0x60,0x12},{{0x19,0xff,0x0c},{0x19,0x1e,0xe1},{0x19,0x31,0x40},{0x19,0x36,0x01},{0x19,0x0a,0x1c},{0x19,0x0a,0x10},{0x19,0x15,0x15},{0x19,0x2d,0x87},{0,0,0}}},
};


/* LOCAL SUBPROGRAM BODIES
*/

static ssize_t show_status(struct device *dev, struct device_attribute *da,
             char *buf)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);

    if (data->active_port > AS6700_32X_MAX_NBR_OF_SFP_PORT || data->active_port < AS6700_32X_SFP_NORMAL_PORT_MIN) {
        return -EINVAL;
    }

    data = as6700_32x_sfp_update_present(dev);
    
    if (data->is_debug) {
        as6700_32x_sfp_debug_present_dump(dev);
    }

    if (data->is_failed < 0) {
        return (data->is_failed);
    } else {
        return sprintf(buf, "%d", data->is_present);
    }
}

static ssize_t show_active_port(struct device *dev, struct device_attribute *da,
             char *buf)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);


    return sprintf(buf, "%ld", data->active_port);
}

static ssize_t set_active_port(struct device *dev, struct device_attribute *da,
			const char *buf, size_t count)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    long active_port=0;
    int error=0;

    error = kstrtol(buf, 10, &active_port);
      if (error) {
        return error;
    }

    if (active_port > AS6700_32X_MAX_NBR_OF_SFP_PORT || active_port < AS6700_32X_SFP_NORMAL_PORT_MIN) {
        return -EINVAL;
    }

    mutex_lock(&data->update_lock);
    data->valid = 1;
    data->active_port = active_port;
    mutex_unlock(&data->update_lock);

    return count;
}

static ssize_t show_eeprom(struct device *dev, struct device_attribute *da,
             char *buf)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);

    if (data->active_port > AS6700_32X_MAX_NBR_OF_SFP_PORT || data->active_port < AS6700_32X_SFP_NORMAL_PORT_MIN) {
        return -EINVAL;
    }

    data = as6700_32x_sfp_update_eeprom(dev);
    memcpy(buf, data->eeprom, sizeof(data->eeprom));
    if (data->is_debug) {
        as6700_32x_sfp_debug_eeprom_dump(dev);
    }

    if (data->is_failed < 0) {
        return (data->is_failed);
    } else {
        return sizeof(data->eeprom);
    }
}

static ssize_t set_sfp_equalizer(struct device *dev, struct device_attribute *da,
			const char *buf, size_t count)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    long cable_type=0;
    int error=0;

    error = kstrtol(buf, 10, &cable_type);
      if (error) {
        return -EINVAL;
    }

    if ((cable_type != AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_FIBER) &&
        (cable_type != AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_1M) &&
        (cable_type != AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_3M) &&
        (cable_type != AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_5M) &&
        (cable_type != AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_7M)) {
        return -EINVAL;
    }

    mutex_lock(&data->update_lock);
    data->cable_type = cable_type;
    data->is_failed = 0;
    as6700_32x_sfp_equalizer_write(client);
    mutex_unlock(&data->update_lock);

    if (data->is_failed < 0) {
        return (data->is_failed);
    } else {
        return count;
   }
}

static ssize_t show_sfp_debug(struct device *dev, struct device_attribute *da,
             char *buf)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);

    return sprintf(buf, "%d", data->is_debug);
}

static ssize_t set_sfp_debug(struct device *dev, struct device_attribute *da,
			const char *buf, size_t count)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    long is_debug=0;
    int error=0;

    error = kstrtol(buf, 10, &is_debug);
      if (error) {
        return error;
    }

    if (is_debug != 0 && is_debug != 1) {
        return -EINVAL;
    }

    mutex_lock(&data->update_lock);
    data->is_debug = is_debug;
    mutex_unlock(&data->update_lock);

    return count;
}

static const struct attribute_group as6700_32x_sfp_group = {
    .attrs = as6700_32x_sfp_attributes,
};

static int as6700_32x_sfp_probe(struct i2c_client *client,
            const struct i2c_device_id *dev_id)
{
    struct as6700_32x_sfp_data *data;
    int status;

    if (!i2c_check_functionality(client->adapter, I2C_FUNC_SMBUS_I2C_BLOCK)) {
        status = -EIO;
        goto exit;
    }

    data = kzalloc(sizeof(struct as6700_32x_sfp_data), GFP_KERNEL);
    if (!data) {
        status = -ENOMEM;
        goto exit;
    }

    i2c_set_clientdata(client, data);
    data->valid = 0;
    data->active_port = 0;
    memset(data->eeprom, 0, sizeof(data->eeprom));
    data->is_present = 0;
    data->is_failed =0;
    data->is_debug=0;
    memset(data->normal_port_present, 0, sizeof(data->normal_port_present));
    memset(data->module_exist, 0, sizeof(data->module_exist));
    memset(data->module_port_present, 0, sizeof(data->module_port_present));
    memset(data->update_normal_port_status, 0, sizeof(data->update_normal_port_status));
    memset(data->update_module_exist_status, 0, sizeof(data->update_module_exist_status));
    memset(data->update_module_port_status, 0, sizeof(data->update_module_port_status));
    data->cable_type = AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_FIBER;
    mutex_init(&data->update_lock);

    dev_dbg(&client->dev,"chip found\n");

    /* Register sysfs hooks */
    status = sysfs_create_group(&client->dev.kobj, &as6700_32x_sfp_group);
    if (status) {
        goto exit_free;
    }

    data->hwmon_dev = hwmon_device_register(&client->dev);
    if (IS_ERR(data->hwmon_dev)) {
        status = PTR_ERR(data->hwmon_dev);
        goto exit_remove;
    }

    dev_dbg(&client->dev,"%s: sfp '%s'\n",
         dev_name(data->hwmon_dev), client->name);
    
    return 0;

exit_remove:
    sysfs_remove_group(&client->dev.kobj, &as6700_32x_sfp_group);
exit_free:
    kfree(data);
exit:
    
    return status;
}

static int as6700_32x_sfp_remove(struct i2c_client *client)
{
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);

    hwmon_device_unregister(data->hwmon_dev);
    sysfs_remove_group(&client->dev.kobj, &as6700_32x_sfp_group);
    kfree(data);
    
    return 0;
}

static const struct i2c_device_id as6700_32x_sfp_id[] = {
    { "acc_as6700_32x_sfp", 0 },
    {}
};
MODULE_DEVICE_TABLE(i2c, as6700_32x_sfp_id);

static struct i2c_driver as6700_32x_sfp_driver = {
    .class        = I2C_CLASS_HWMON,
    .driver = {
       .name     = AS6700_32X_DRVNAME,
    },
    .probe        = as6700_32x_sfp_probe,
    .remove       = as6700_32x_sfp_remove,
    .id_table     = as6700_32x_sfp_id,
    .address_list = normal_i2c,
};

static int as6700_32x_sfp_read_block(struct i2c_client *client, u8 command, u8 *data,
              int data_len)
{
    int result = i2c_smbus_read_i2c_block_data(client, command, data_len, data);
    
    if (unlikely(result < 0))
        goto abort;
    if (unlikely(result != data_len)) {
        result = -EIO;
        goto abort;
    }
    
    result = 0;
    
abort:
    return result;
}

static int as6700_32x_sfp_read_normal_port_present(struct i2c_client *client)
{
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int read_byte = -1, idx=0, reg_offset_size=0;
    
    reg_offset_size =sizeof(as6700_32x_CPLD_normal_port_present_offset);
    for (idx=0; idx < reg_offset_size; idx++)
    {
        read_byte = accton_i2c_cpld_read(AS6700_32X_SFP_CPLD_ADDR, as6700_32x_CPLD_normal_port_present_offset[idx]);
        if (read_byte < 0) {
            data->update_normal_port_status[idx] = AS6700_32X_SFP_ERROR_CODE;
            dev_dbg(&client->dev,"addr(0x%x) offset(0x%x) read err %d\n",
                    AS6700_32X_SFP_CPLD_ADDR,
                    as6700_32x_CPLD_normal_port_present_offset[idx],
                    read_byte);
            continue;
        }

        if (idx == reg_offset_size -1) {
            data->normal_port_present[idx] = ~read_byte & 0xf;
        }
        else {
            data->normal_port_present[idx] = ~read_byte & 0xff;
        }
    }

    return 0;
}

static int as6700_32x_sfp_read_module_port_present(struct i2c_client *client)
{
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int result=-1, read_byte=-1, idx=0, value_size=0;
    u8 driver_port =0, module_exist_bit=0;

    read_byte = accton_i2c_cpld_read(AS6700_32X_SFP_CPLD_ADDR, as6700_32x_CPLD_module_exist_offset[0]);
    if (read_byte < 0) {
        data->update_module_exist_status[AS6700_32X_SFP_MODULE_ONE_INDEX] = AS6700_32X_SFP_ERROR_CODE;
        data->update_module_exist_status[AS6700_32X_SFP_MODULE_TWO_INDEX] = AS6700_32X_SFP_ERROR_CODE;
        dev_dbg(&client->dev,"addr(0x%x) offset(0x%x) read err %d\n",
                AS6700_32X_SFP_CPLD_ADDR,
                as6700_32x_CPLD_module_exist_offset[0],
                read_byte);
    } else {
        driver_port = AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(data->active_port);
        module_exist_bit = AS6700_32X_SFP_GET_MODULE_PORT_BLOCK_INDEX(driver_port);
        data->module_exist[AS6700_32X_SFP_MODULE_ONE_INDEX] = (~read_byte >> module_exist_bit) & 0x01;
        data->module_exist[AS6700_32X_SFP_MODULE_TWO_INDEX] = (~read_byte >> module_exist_bit) & 0x01;
        if (data->is_debug) {
            dev_dbg(&client->dev,"addr(0x%x) offset(0x%x) read err %d\n",
                AS6700_32X_SFP_CPLD_ADDR,
                as6700_32x_CPLD_module_exist_offset[0],
                read_byte);
        }
    }

    value_size = sizeof(as6700_32x_SC_module_port_value);
    for (idx=0; idx < value_size; idx++)
    {
        if (data->update_module_exist_status[idx] != AS6700_32X_SFP_ERROR_CODE &&
            data->module_exist[idx] == 1)
        {
            result = accton_i2c_cpld_write(AS6700_32X_SFP_CPLD_ADDR,
                                           AS6700_32X_SFP_SWITCH_CHANNEL_REG, 
                                           as6700_32x_SC_module_port_value[idx]);
            if (result < 0) {
                data->update_module_port_status[idx] = AS6700_32X_SFP_ERROR_CODE;
                dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                        AS6700_32X_SFP_CPLD_ADDR,
                        AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                        as6700_32x_SC_module_port_value[idx],
                        result);
                continue;
            } else {
                if (data->is_debug) {
                    dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                            AS6700_32X_SFP_CPLD_ADDR,
                            AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                            as6700_32x_SC_module_port_value[idx],
                            result);
                }
            }

            read_byte = accton_i2c_cpld_read(AS6700_32X_SFP_IO_EXPANDER_ADDR, as6700_32x_IE_module_io_expander_offset[0]);
            if (read_byte < 0) {
                data->update_module_port_status[idx] = AS6700_32X_SFP_ERROR_CODE;
                dev_dbg(&client->dev,"cpld(0x%x) reg(0x%x) read err %d\n",
                        AS6700_32X_SFP_IO_EXPANDER_ADDR,
                        as6700_32x_IE_module_io_expander_offset[0],
                        read_byte);
                continue;
            } else {
                if (data->is_debug) {
                    dev_dbg(&client->dev,"cpld(0x%x) reg(0x%x) read err %d\n",
                            AS6700_32X_SFP_IO_EXPANDER_ADDR,
                            as6700_32x_IE_module_io_expander_offset[0],
                            read_byte);
                }
                data->module_port_present[idx] = ~read_byte & 0xfc;
            }

            /* Inactive the Switch Channel
             */
            result = accton_i2c_cpld_write(AS6700_32X_SFP_CPLD_ADDR,
                                           AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                                           AS6700_32X_SFP_SC_INACTIVATE_VLAUE);
            if (result < 0) {
                dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                        AS6700_32X_SFP_CPLD_ADDR,
                        AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                        AS6700_32X_SFP_SC_INACTIVATE_VLAUE,
                        result);
                continue;
            } else {
                if (data->is_debug) {
                    dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                            AS6700_32X_SFP_CPLD_ADDR,
                            AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                            AS6700_32X_SFP_SC_INACTIVATE_VLAUE,
                            result);
                }
            }
        }
    }

    return 0;
}

static int as6700_32x_sfp_read_normal_port_eeprom(struct i2c_client *client)
{
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int result=-1, idx=0;
    u8 driver_port =0;

    driver_port = AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(data->active_port);

    result = accton_i2c_cpld_write(AS6700_32X_SFP_CPLD_ADDR, 
                                   AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                                   as6700_32x_SC_normal_port_value[driver_port]);
    if (result < 0) {
        dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value (0x%x) write err %d\n",
                AS6700_32X_SFP_CPLD_ADDR,
                AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                as6700_32x_SC_normal_port_value[driver_port],
                result);
        result = -EIO;
        goto abort;
    } else {
        if (data->is_debug) {
            dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value (0x%x) write err %d\n",
                    AS6700_32X_SFP_CPLD_ADDR,
                    AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                    as6700_32x_SC_normal_port_value[driver_port],
                    result);
        }
    }

    for (idx = 0; idx < sizeof(data->eeprom)/I2C_SMBUS_BLOCK_MAX; idx++) {
        result = as6700_32x_sfp_read_block(client, idx*I2C_SMBUS_BLOCK_MAX,
                                           data->eeprom+(idx*I2C_SMBUS_BLOCK_MAX),
                                           I2C_SMBUS_BLOCK_MAX);
        if (result < 0) {
            dev_dbg(&client->dev,"unable to read eeprom from port(%ld)\n", data->active_port);
            result = -EIO;
            goto abort;
        }
    }

   /* Inactive the Switch Channel
    */
    result = accton_i2c_cpld_write(AS6700_32X_SFP_CPLD_ADDR, 
                                   AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                                   AS6700_32X_SFP_SC_INACTIVATE_VLAUE);
    if (result < 0) {
        dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                AS6700_32X_SFP_CPLD_ADDR,
                AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                AS6700_32X_SFP_SC_INACTIVATE_VLAUE,
                result);
        result = -EIO;
        goto abort;
    } else {
        if (data->is_debug) {
            dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    AS6700_32X_SFP_CPLD_ADDR,
                    AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                    AS6700_32X_SFP_SC_INACTIVATE_VLAUE,
                    result);
        }
    }

    result=0;

abort:
    return result;
}

static int as6700_32x_sfp_read_module_port_eeprom(struct i2c_client *client)
{
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int result=-1, idx=0;
    u8 driver_port =0;
    u8 module_port_bit=0;

    driver_port = AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(data->active_port);
    module_port_bit = AS6700_32X_SFP_GET_MODULE_PORT_BLOCK_BIT_INDEX(driver_port);

    result = accton_i2c_cpld_write(AS6700_32X_SFP_CPLD_ADDR,
                                   AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                                   as6700_32x_SC_module_port_value[AS6700_32X_SFP_GET_SC_MODULE_PORT_VALUE_INDEX(driver_port)]);
    if (result < 0) {
        dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                AS6700_32X_SFP_CPLD_ADDR,
                AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                as6700_32x_SC_module_port_value[AS6700_32X_SFP_GET_SC_MODULE_PORT_VALUE_INDEX(driver_port)],
                result);
        result = -EIO;
        goto abort;
    } else {
        if (data->is_debug) {
            dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    AS6700_32X_SFP_CPLD_ADDR,
                    AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                    as6700_32x_SC_module_port_value[AS6700_32X_SFP_GET_SC_MODULE_PORT_VALUE_INDEX(driver_port)],
                    result);
        }
    }

   /* as6700_32x_SI_module_port_value is indexed from 0
    */
    result = accton_i2c_cpld_write(AS6700_32X_SFP_SWITCH_IC_ADDR,
                                   AS6700_32X_SFP_SWITCH_IC_MODULE_REG,
                                   as6700_32x_SI_module_port_value[(module_port_bit-2)]);
    if (result < 0) {
        dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                AS6700_32X_SFP_SWITCH_IC_ADDR,
                AS6700_32X_SFP_SWITCH_IC_MODULE_REG,
                as6700_32x_SI_module_port_value[(module_port_bit-2)],
                result);
        result = -EIO;
        goto abort;
    } else {
        if (data->is_debug) {
            dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    AS6700_32X_SFP_SWITCH_IC_ADDR,
                    AS6700_32X_SFP_SWITCH_IC_MODULE_REG,
                    as6700_32x_SI_module_port_value[(module_port_bit-2)],
                    result);
        }
    }

    for (idx = 0; idx < sizeof(data->eeprom)/I2C_SMBUS_BLOCK_MAX; idx++) {
        result = as6700_32x_sfp_read_block(client, idx*I2C_SMBUS_BLOCK_MAX,
                                           data->eeprom+(idx*I2C_SMBUS_BLOCK_MAX),
                                           I2C_SMBUS_BLOCK_MAX);
        if (result < 0) {
            dev_dbg(&client->dev,"unable to read eeprom from port(%ld)\n", data->active_port);
            result = -EIO;
            goto abort;
        }
    }

    result = accton_i2c_cpld_write(AS6700_32X_SFP_CPLD_ADDR, 
                                   AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                                   AS6700_32X_SFP_SC_INACTIVATE_VLAUE);
    if (result < 0) {
        dev_dbg(&client->dev,"addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                AS6700_32X_SFP_CPLD_ADDR,
                AS6700_32X_SFP_SWITCH_CHANNEL_REG,
                AS6700_32X_SFP_SC_INACTIVATE_VLAUE,
                result);
        result = -EIO;
        goto abort;
    }

    result=0;

abort:
    return result;
}

static int as6700_32x_sfp_equalizer_write(struct i2c_client *client)
{
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int result = -1, idx=0;
    sfp_equalizer_entry_t *eq_table = NULL;
    u8 driver_port =0;
    char eq_type_str[AS6700_32X_SFP_EQUALIZER_TYPE_NAME_LEN];

    memset(eq_type_str, 0, sizeof(eq_type_str));

    driver_port = AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(data->active_port);

    switch (data->cable_type) {
        case AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_FIBER:
            eq_table = &(as6700_32x_sfp_equalizer_table_fiber[driver_port]);
            snprintf(eq_type_str, sizeof(eq_type_str), "%s", "FIBER");
            break;
        case AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_1M:
            eq_table = &(as6700_32x_sfp_equalizer_table_copper_1M[driver_port]);
            snprintf(eq_type_str, sizeof(eq_type_str), "%s", "COPPER_1M");
            break;
        case AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_3M:
            eq_table = &(as6700_32x_sfp_equalizer_table_copper_3M[driver_port]);
            snprintf(eq_type_str, sizeof(eq_type_str), "%s", "COPPER_3M");
            break;
        case AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_5M:
        case AS6700_32X_SFP_TRANCEIVER_CABLE_TYPE_COPPER_7M:
            eq_table = &(as6700_32x_sfp_equalizer_table_copper_5_7_M[driver_port]);
            snprintf(eq_type_str, sizeof(eq_type_str), "%s", "COPPER_5_7_M");
            break;
        default:
            result = -EINVAL;
            goto abort;
    }
  
    result = accton_i2c_cpld_write(eq_table->tx_sc_activate.addr,
                                   eq_table->tx_sc_activate.reg,
                                   eq_table->tx_sc_activate.value);
    if (result < 0) {
        dev_dbg(&client->dev,"tx_activ eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                eq_type_str, eq_table->front_port,
                eq_table->tx_sc_activate.addr,
                eq_table->tx_sc_activate.reg,
                eq_table->tx_sc_activate.value,
                result);
        result = -EIO;
        goto abort;
    } else {
        if (data->is_debug) {
            dev_dbg(&client->dev,"tx_activ eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    eq_type_str, eq_table->front_port,
                    eq_table->tx_sc_activate.addr,
                    eq_table->tx_sc_activate.reg,
                    eq_table->tx_sc_activate.value,
                    result);
        }
    }

    for (idx=0; idx < AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF; idx++) {
        if (eq_table->tx_entry[idx].addr == 0) continue;
        result = accton_i2c_cpld_write(eq_table->tx_entry[idx].addr,
                                       eq_table->tx_entry[idx].reg,
                                       eq_table->tx_entry[idx].value);
        if (result < 0) {
            dev_dbg(&client->dev,"tx_entry[%d/%d] eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    idx, AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF,
                    eq_type_str, eq_table->front_port,
                    eq_table->tx_entry[idx].addr,
                    eq_table->tx_entry[idx].reg,
                    eq_table->tx_entry[idx].value,
                    result);
            result = -EIO;
            goto abort;
         } else {
            if (data->is_debug) {
                dev_dbg(&client->dev,"tx_entry[%d/%d] eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                        idx, AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF,
                        eq_type_str, eq_table->front_port,
                        eq_table->tx_entry[idx].addr,
                        eq_table->tx_entry[idx].reg,
                        eq_table->tx_entry[idx].value,
                        result);
             }
         }
    }

    result = accton_i2c_cpld_write(eq_table->rx_sc_activate.addr,
                                   eq_table->rx_sc_activate.reg,
                                   eq_table->rx_sc_activate.value);
    if (result < 0) {
        dev_dbg(&client->dev,"rx_activ eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                eq_type_str, eq_table->front_port,
                eq_table->rx_sc_activate.addr,
                eq_table->rx_sc_activate.reg,
                eq_table->rx_sc_activate.value,
                result);
        result = -EIO;
        goto abort;
    } else {
        if (data->is_debug) {
            dev_dbg(&client->dev,"rx_activ eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    eq_type_str, eq_table->front_port,
                    eq_table->rx_sc_activate.addr,
                    eq_table->rx_sc_activate.reg,
                    eq_table->rx_sc_activate.value,
                    result);
        }
    }

    for (idx=0; idx < AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF; idx++) {
        if (eq_table->rx_entry[idx].addr == 0) continue;
        result = accton_i2c_cpld_write(eq_table->rx_entry[idx].addr,
                                       eq_table->rx_entry[idx].reg,
                                       eq_table->rx_entry[idx].value);
        if (result < 0) {
            dev_dbg(&client->dev,"rx_entry[%d/%d] eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    idx, AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF,
                    eq_type_str, eq_table->front_port,
                    eq_table->rx_entry[idx].addr,
                    eq_table->rx_entry[idx].reg,
                    eq_table->rx_entry[idx].value,
                    result);
            result = -EIO;
            goto abort;
         } else {
            if (data->is_debug) {
                 dev_dbg(&client->dev,"rx_entry[%d/%d] eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                        idx, AS6700_32X_MAX_NBR_OF_SFP_EQUALIZER_CONF,
                        eq_type_str, eq_table->front_port,
                        eq_table->rx_entry[idx].addr,
                        eq_table->rx_entry[idx].reg,
                        eq_table->rx_entry[idx].value,
                        result);
             }
         }
    }

    result = accton_i2c_cpld_write(eq_table->sc_inactivate.addr,
                                   eq_table->sc_inactivate.reg,
                                   eq_table->sc_inactivate.value);
    if (result < 0) {
        dev_dbg(&client->dev,"sc_inact eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                eq_type_str, eq_table->front_port,
                eq_table->sc_inactivate.addr,
                eq_table->sc_inactivate.reg,
                eq_table->sc_inactivate.value,
                result);
        result = -EIO;
        goto abort;
    } else {
        if (data->is_debug) {
            dev_dbg(&client->dev,"sc_inact eq_type(%s) front_port(%d) addr(0x%x) reg(0x%x) value(0x%x) write err %d\n",
                    eq_type_str, eq_table->front_port,
                    eq_table->sc_inactivate.addr,
                    eq_table->sc_inactivate.reg,
                    eq_table->sc_inactivate.value,
                    result);
        }
    }

    result = 0;
    
abort:
    data->is_failed = result;
    return (data->is_failed);
}

static void as6700_32x_sfp_debug_present_dump(struct device *dev)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);

    mutex_lock(&data->update_lock);

    dev_dbg(&client->dev,"---------- Start of as6700_32x sfp debug present dump\n");
    dev_dbg(&client->dev,"active_port=[%ld]\n", data->active_port);
    dev_dbg(&client->dev,"cable_type=[%ld]\n", data->cable_type);
    dev_dbg(&client->dev,"update_normal_port_status=[2#(%d)][1#(%d)][0#(%d)]\n",
                          data->update_normal_port_status[2],
                          data->update_normal_port_status[1],
                          data->update_normal_port_status[0]);
    dev_dbg(&client->dev,"update_module_exist_status=[1#(%d)][0#(%d)]\n",
                          data->update_module_exist_status[1],
                          data->update_module_exist_status[0]);
    dev_dbg(&client->dev,"update_module_port_status=[1#(%d)][0#(%d)]\n",
                          data->update_module_port_status[1],
                          data->update_module_port_status[0]);
    dev_dbg(&client->dev,"normal_port_present=[2#(0x%2x)][1#(0x%2x)][0#(0x%2x)]\n",
                          data->normal_port_present[2],
                          data->normal_port_present[1],
                          data->normal_port_present[0]);
    dev_dbg(&client->dev,"module_exist=[1#(0x%2x)][0#(0x%2x)]\n",
                          data->module_exist[1],
                          data->module_exist[0]);
    dev_dbg(&client->dev,"module_port_present=[1#(0x%2x)][0#(0x%2x)]\n",
                          data->module_port_present[1],
                          data->module_port_present[0]);
    dev_dbg(&client->dev,"is_present=[%d]\n", data->is_present);
    dev_dbg(&client->dev,"----------End of as6700_32x sfp debug present dump\n");
    mutex_unlock(&data->update_lock);

}

static struct as6700_32x_sfp_data *as6700_32x_sfp_update_present(struct device *dev)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int is_normal_port_failed = 0, is_module_exist_failed =0, is_module_port_failed = 0;
    u8 driver_port =0;
    u8 normal_port_block_index=0, normal_port_bit=0;
    u8 module_port_block_index=0, module_port_bit=0;


    mutex_lock(&data->update_lock);
    if (data->is_debug) {
        dev_dbg(&client->dev,"Starting as6700_32x sfp present update\n");
    }
    data->is_present = 0;
    data->is_failed =0;
    memset(data->normal_port_present, 0, sizeof(data->normal_port_present));
    memset(data->module_exist, 0, sizeof(data->module_exist));
    memset(data->module_port_present, 0, sizeof(data->module_port_present));
    memset(data->update_normal_port_status, 0, sizeof(data->update_normal_port_status));
    memset(data->update_module_exist_status, 0, sizeof(data->update_module_exist_status));
    memset(data->update_module_port_status, 0, sizeof(data->update_module_port_status));
    driver_port = AS6700_32X_SFP_MAP_FRONT_2_DRIVER_PORT(data->active_port);
    if (AS6700_32X_SFP_IS_MODULE_PORT(data->active_port)) {
        as6700_32x_sfp_read_module_port_present(client);
        is_module_exist_failed = data->update_module_exist_status[AS6700_32X_SFP_GET_SC_MODULE_PORT_VALUE_INDEX(driver_port)];
        is_module_port_failed = data->update_module_port_status[AS6700_32X_SFP_GET_SC_MODULE_PORT_VALUE_INDEX(driver_port)];
        if (is_module_exist_failed == AS6700_32X_SFP_ERROR_CODE || is_module_port_failed == AS6700_32X_SFP_ERROR_CODE) {
            data-> is_failed = AS6700_32X_SFP_ERROR_CODE;
        } else {
            module_port_block_index  = AS6700_32X_SFP_GET_MODULE_PORT_BLOCK_INDEX(driver_port);
            module_port_bit = AS6700_32X_SFP_GET_MODULE_PORT_BLOCK_BIT_INDEX(driver_port);
            data->is_present=(data->module_port_present[module_port_block_index] >> module_port_bit) & 0x01;
            if (data->is_debug) {
                dev_dbg(&client->dev,"%d: module_port_block_index=[0x%x]\n", __LINE__, module_port_block_index);
                dev_dbg(&client->dev,"%d: data->module_port_present[module_port_block_index]=[0x%x]\n", __LINE__, data->module_port_present[module_port_block_index]);
                dev_dbg(&client->dev,"%d: module_port_bit=[0x%x]\n", __LINE__, module_port_bit);
                dev_dbg(&client->dev,"%d: is_present=[0x%x]\n", __LINE__, data->is_present);
            }
        }
    }
    else{
        as6700_32x_sfp_read_normal_port_present(client);
        is_normal_port_failed=data->update_normal_port_status[data->active_port/8];
        if (is_normal_port_failed == AS6700_32X_SFP_ERROR_CODE) {
           data-> is_failed = AS6700_32X_SFP_ERROR_CODE;
        } else {
            normal_port_block_index = AS6700_32X_SFP_GET_NORMAL_PORT_BLOCK_INDEX(driver_port);
            normal_port_bit=AS6700_32X_SFP_GET_NORMAL_PORT_BLOCK_BIT_INDEX(driver_port);
            data->is_present= (data->normal_port_present[normal_port_block_index] >> normal_port_bit) & 0x01;
            if (data->is_debug) {
                dev_dbg(&client->dev,"%d: normal_port_block_index=[0x%x]\n", __LINE__, normal_port_block_index);
                dev_dbg(&client->dev,"%d: data->normal_port_present[normal_port_block_index]=[0x%x]\n", __LINE__, data->normal_port_present[normal_port_block_index]);
                dev_dbg(&client->dev,"%d: normal_port_bit=[0x%x]\n", __LINE__, normal_port_bit);
                dev_dbg(&client->dev,"%d: is_present=[0x%x]\n", __LINE__, data->is_present);
            }
        }
    }
    mutex_unlock(&data->update_lock);

    return data;
}

static void as6700_32x_sfp_debug_eeprom_dump(struct device *dev)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int idx =0;

    mutex_lock(&data->update_lock);
    dev_dbg(&client->dev,"\n---------- Start of as6700_32x sfp debug eeprom dump (Front Port: %ld)\n", data->active_port);
    for (idx = 0; idx < 16; idx++) {
         dev_dbg(&client->dev,"%2x %2x %2x %2x %2x %2x %2x %2x %2x %2x %2x %2x %2x %2x %2x %2x\n", 
                data->eeprom[(16*idx)+0],data->eeprom[(16*idx)+1],data->eeprom[(16*idx)+2],data->eeprom[(16*idx)+3],
                data->eeprom[(16*idx)+4],data->eeprom[(16*idx)+5],data->eeprom[(16*idx)+6],data->eeprom[(16*idx)+7],
                data->eeprom[(16*idx)+8],data->eeprom[(16*idx)+9],data->eeprom[(16*idx)+10],data->eeprom[(16*idx)+11],
                data->eeprom[(16*idx)+12],data->eeprom[(16*idx)+13],data->eeprom[(16*idx)+14],data->eeprom[(16*idx)+15]);
    }
    dev_dbg(&client->dev,"\n----------End of as6700_32x sfp debug eeprom dump\n");
    mutex_unlock(&data->update_lock);
}

static struct as6700_32x_sfp_data *as6700_32x_sfp_update_eeprom(struct device *dev)
{
    struct i2c_client *client = to_i2c_client(dev);
    struct as6700_32x_sfp_data *data = i2c_get_clientdata(client);
    int status = -1;

    mutex_lock(&data->update_lock);
    if (data->is_debug) {
        dev_dbg(&client->dev,"Starting as6700_32x sfp eeprom update\n");
    }
    memset(data->eeprom, 0, sizeof(data->eeprom));
    data->is_failed =0;
    if (AS6700_32X_SFP_IS_MODULE_PORT(data->active_port)) {
        status=as6700_32x_sfp_read_module_port_eeprom(client);
    } else {
        status=as6700_32x_sfp_read_normal_port_eeprom(client);
    }

    if (status < 0){
        memset(data->eeprom, 0, sizeof(data->eeprom));
        data->is_failed = AS6700_32X_SFP_ERROR_CODE;
    }

    mutex_unlock(&data->update_lock);

    return data;
}

static int __init as6700_32x_sfp_init(void)
{
    return i2c_add_driver(&as6700_32x_sfp_driver);
}

static void __exit as6700_32x_sfp_exit(void)
{
    i2c_del_driver(&as6700_32x_sfp_driver);
}

MODULE_AUTHOR("Brandon Chuang <brandon_chuang@accton.com.tw>");
MODULE_DESCRIPTION("accton as6700_32x_sfp driver");
MODULE_LICENSE("GPL");

module_init(as6700_32x_sfp_init);
module_exit(as6700_32x_sfp_exit);

